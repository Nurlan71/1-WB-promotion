# Wildberries Google Apps Script Manager

Это проект Google Apps Script, предназначенный для управления аккаунтом продавца Wildberries непосредственно из Google Таблиц. Он позволяет автоматизировать получение статистики, управление рекламными кампаниями, работу с отзывами и многое другое.

## Структура проекта

Проект состоит из двух основных файлов:

1.  `WildberriesAPI.js`: Библиотека для работы с API Wildberries.
2.  `Main.js`: Основной скрипт, который использует библиотеку и управляет данными в Google Таблице.

### `WildberriesAPI.js`

Это переиспользуемая библиотека, которая инкапсулирует всю логику взаимодействия с API Wildberries.

**Особенности:**
- **Модульность:** Методы сгруппированы по разделам API (`advert`, `statistics`, `content` и т.д.).
- **Надежность:** Централизованная функция для отправки запросов с обработкой ошибок.
- **Гибкость:** Поддержка различных типов авторизации (с `Bearer` токеном и без).
- **Удобство:** Встроенная логика для сложных операций, таких как постраничная загрузка данных (пагинация).

### `Main.js`

Этот файл содержит основную логику вашего приложения. Он отвечает за:
- Создание пользовательского меню в Google Таблице.
- Отображение диалоговых окон для ввода данных.
- Вызов методов из библиотеки `WildberriesAPI.js` для получения или отправки данных.
- Взаимодействие с вашим объектом `Ecommonkey.Wildberries` для записи данных на листы и другой специфичной для таблиц логики.

## Начало работы

1.  **Скопируйте код:** Перенесите содержимое обоих файлов, `WildberriesAPI.js` и `Main.js`, в ваш проект Google Apps Script. Убедитесь, что они находятся на одном уровне в проекте.
2.  **Настройте API ключи:** В меню вашей таблицы должна быть опция для вызова диалогового окна (`showApiKeyDialog`), где вы можете ввести и сохранить ваши API-ключи.
3.  **Используйте меню:** Функции скрипта, как правило, вызываются через кастомное меню, которое появляется в вашей Google Таблице после открытия.

## Важное замечание

Скрипт в `Main.js` активно использует объект `Ecommonkey.Wildberries` для выполнения множества вспомогательных операций (например, `Ecommonkey.Wildberries.setupAdvertSheet()`, `Ecommonkey.Wildberries.processIncomeData()` и т.д.).

Предполагается, что этот объект определен в вашем проекте отдельно. Данный рефакторинг **не затрагивал** код внутри `Ecommonkey.Wildberries`, а лишь отделил от него прямые вызовы к API Wildberries.
